% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_sagl_flight_path.R
\name{create_sagl_flight_path}
\alias{create_sagl_flight_path}
\title{Create a Smart AGL Flight Path}
\usage{
create_sagl_flight_path(
  deploy_coords,
  land_coords,
  dsm_path,
  N = 100,
  H = 10,
  speed_p = 5,
  crs_proj = "EPSG:32632",
  minDist = 1,
  calfig_params = NULL
)
}
\arguments{
\item{deploy_coords}{Numeric vector of length 2 containing deployment coordinates (x,y)
in the specified CRS (default UTM Zone 32N)}

\item{land_coords}{Numeric vector of length 2 containing landing coordinates (x,y)
in the same CRS as deployment coordinates}

\item{dsm_path}{Character string specifying path to Digital Surface Model (DSM) raster file.
The DSM should cover the entire flight path area.}

\item{N}{Integer specifying number of sample points along the path (default = 100).
Higher values provide more precise terrain following but increase computation time.}

\item{H}{Numeric value for desired height above ground level (AGL) in meters (default = 10).
This is the constant clearance maintained above terrain.}

\item{speed_p}{Numeric value for flight speed to assign to waypoints in m/s (default = 5)}

\item{crs_proj}{Character string or CRS object specifying the projected coordinate
reference system (default: "EPSG:32632" - UTM Zone 32N)}

\item{minDist}{Numeric value specifying minimum distance between trajectory points
(enforces UgCS restriction, default = 1 meter)}

\item{calfig_params}{Optional list of parameters for calibration figure pattern:
\itemize{
\item \code{Lat}: Latitude coordinate for calibration figure center (numeric)
\item \code{Lon}: Longitude coordinate for calibration figure center (numeric)
\item \code{angle}: Initial angle in degrees (default = 90)
\item \code{res}: Number of points per circle (default = 12)
\item \code{diam}: Diameter of circles in meters (default = 15)
\item \code{speed_c}: Speed value for calibration points (default = 5 m/s)
\item \code{H_cal}: Height for calibration points (default = same as main H)
}}
}
\value{
A list object containing:
\itemize{
\item \code{deploy_coords}: Original deployment coordinates
\item \code{land_coords}: Original landing coordinates
\item \code{sampled_points}: sf object of sampled terrain points with elevations
\item \code{terrain_line}: LineString of raw terrain profile
\item \code{simple_shift_line}: LineString of naively elevated path (constant offset)
\item \code{smart_agl_line}: Optimized AGL path (simplified LineString)
\item \code{final_coords}: Data frame of final flight coordinates with columns:
\itemize{
\item X, Y, Z: Coordinates
\item Type: Point type ("Trajectory" or "Cal")
\item Speed: Assigned speed in m/s
}
\item \code{dsm_extent}: Polygon of DSM coverage area (WGS84)
\item \code{aoi_kml}: Simplified flight corridor polygon (KML-ready, WGS84)
\item \code{parameters}: List of input parameters used
}
}
\description{
Generates an optimized 3D flight path that maintains constant height above ground level (AGL)
between deployment and landing coordinates. The function uses digital surface model (DSM) data
to create terrain-aware trajectories that automatically adjust elevation to maintain safe
clearance above varying terrain.
}
\details{
The function performs the following key operations:
\enumerate{
\item Validates input coordinates and parameters
\item Loads and projects DSM data to the specified coordinate system
\item Creates a direct line between deployment and landing points
\item Samples points along the line and extracts terrain elevations
\item Generates an optimized path that maintains constant AGL height
\item Optionally adds calibration patterns at start/end of flight
\item Performs safety checks and provides warnings for potential issues
}

The output includes both the raw terrain data and optimized flight path, along with
visualization-ready components and safety metrics.
}
\section{Warning}{

The function will warn if:
\itemize{
\item The flight path exceeds 99 waypoints (DJI limit)
\item The flight path extends beyond DSM coverage
\item Calibration figures are not included when expected
}
}

\examples{
\dontrun{
# Basic usage
flight_path <- create_sagl_flight_path(
  deploy_coords = c(580000, 5510000),
  land_coords = c(580500, 5510500),
  dsm_path = "path/to/dsm.tif",
  H = 15
)

# With calibration figures
flight_path <- create_sagl_flight_path(
  deploy_coords = c(580000, 5510000),
  land_coords = c(580500, 5510500),
  dsm_path = "path/to/dsm.tif",
  calfig_params = list(Lat = 49.7, Lon = 8.3, diam = 20)
)
}

}
\seealso{
For visualization of results, see \code{\link{plot_flight_profile}}. For KML export,
use the \code{aoi_kml} output with \code{\link[sf]{st_write}}.
}
